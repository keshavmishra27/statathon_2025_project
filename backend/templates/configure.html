{% extends "base.html" %}
{% block title %}Configure Processing{% endblock %}

{% block content %}
<link href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css" rel="stylesheet">

<div class="container my-5">
    <div class="card shadow-lg p-4 bg-dark text-light rounded-4" data-aos="fade-up">
        <h2 class="text-center mb-4 text-gradient">‚öô Schema Mapping & Processing Configuration</h2>

        <form method="POST">
            <!-- Schema Mapping -->
            <div class="mb-4">
                <h5 class="fw-bold">üóÇ Schema Mapping</h5>
                {% for col in columns %}
                <div class="row mb-2">
                    <div class="col-md-5">
                        <label class="form-label">{{ col }}</label>
                    </div>
                    <div class="col-md-7">
                        <input type="text" class="form-control" name="map_{{ col }}" 
                               value="{{ ai_suggest[col] if ai_suggest[col] else col }}">
                    </div>
                </div>
                {% endfor %}
            </div>

            <!-- Imputation -->
            <div class="mb-4">
                <h5 class="fw-bold">üîß Missing Value Imputation</h5>
                <select class="form-select" name="imputation_method">
                    <option value="mean">Mean</option>
                    <option value="median">Median</option>
                    <option value="knn">KNN Imputer</option>
                </select>
                <div class="form-check mt-2">
                    <input class="form-check-input" type="checkbox" name="ai_impute" id="ai_impute">
                    <label class="form-check-label" for="ai_impute">Use AI-powered Imputation</label>
                </div>
            </div>

            <!-- Outlier Detection -->
            <div class="mb-4">
                <h5 class="fw-bold">üìä Outlier Detection</h5>
                <select class="form-select" name="outlier_method">
                    <option value="isolationforest">Isolation Forest</option>
                    <option value="iqr">IQR Method</option>
                </select>
            </div>

            <!-- Rules -->
            <div class="mb-4">
                <h5 class="fw-bold">üìè Validation Rules</h5>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="rules" value="age_limit" id="rule_age">
                    <label class="form-check-label" for="rule_age">Age &lt; 120</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="rules" value="income_positive" id="rule_income">
                    <label class="form-check-label" for="rule_income">Income &gt; 0</label>
                </div>
            </div>

            <!-- Weights -->
            <div class="mb-4">
                <h5 class="fw-bold">‚öñ Weight Column</h5>
                <select class="form-select" name="weight_column">
                    <option value="">-- None --</option>
                    {% for col in columns %}
                    <option value="{{ col }}">{{ col }}</option>
                    {% endfor %}
                </select>
            </div>

            <!-- Action Buttons -->
            <div class="text-center">
                <button type="submit" name="action" value="analyze" class="btn btn-primary btn-lg px-4 glow-btn" data-aos="zoom-in">
                    üöÄ Run Analysis
                </button>
                <button type="submit" name="action" value="visualize" class="btn btn-outline-light btn-lg px-4 ms-3 glow-btn" data-aos="zoom-in">
                    üìà Visualize
                </button>
            </div>
        </form>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
<script>AOS.init({ duration: 1200, once: true });</script>

<style>
    body {
        background: linear-gradient(135deg, #1e3a5f, #0d1b2a);
        color: #fff;
        font-family: 'Segoe UI', sans-serif;
    }
    .text-gradient {
        background: linear-gradient(to right, #00c6ff, #0072ff);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }
    .glow-btn {
        border-radius: 12px;
        box-shadow: 0 0 15px rgba(0, 123, 255, 0.7);
        transition: 0.3s;
    }
    .glow-btn:hover {
        box-shadow: 0 0 25px rgba(0, 123, 255, 1);
        transform: scale(1.05);
    }
</style>
{% endblock %}
